\chapter{Python Tests}
\label{ch:python}

\section{Introduction}

\tab
NetCDF provides python tests that are available in the directory \textbf{esdm-netcdf/dev}. The procedures to run the tests are following.

Run the build script:

\begin{framed}
\$ ./build.sh
\end{framed}

Python tests are created now inside the directory \textbf{dev/netcdf4-python/test}. Go to that directory.

\begin{framed}
\$ cd netcdf4-python/test
\end{framed}

Now, copy or link the \textbf{\_esdm.conf} file to this directory. A possible example is:

\begin{framed}
\$ cp ../../../build/libsrcesdm\_test/\_esdm.conf .
\end{framed}

All Python tests start with the string \textbf{tst\_}. This string has to change to enable us to run \textbf{pytest}. To do that, one option is install the \textbf{mmv} utility. Note that the tests names need to be changed, but the tests files (\textbf{.nc} files) have to remain unchanged.

\begin{framed}
\$ sudo apt-get install mmv\\
\$ mmv tst\*.py test\#1.py
\end{framed}

Now, run the \textbf{mkfs.esdm} utility with the following parameters.

\begin{framed}
\$ mkfs.esdm --create --remove --ignore-errors -g -c \_esdm.conf
\end{framed}

Finally, install and run the \textbf{pytest} utility.

\begin{framed}
\$ sudo apt-get install python3-pytest \\
\$ pytest --junitxml results.xml
\end{framed}

The file \textbf{results.xml} can now be uploaded by Jenkins wchi provides the results in Table tab.

\section{Tests}

\tab
The next sections introduce the information about each Python test. For them to run with ESDM, two strings were replaced in all tests that contain them. The commands for this substitution can be found in the file \textbf{build.sh}.

\begin{verbatim}
sed -i 's#tempfile.NamedTemporaryFile(.*delete=False).name#"esdm://testfile'$RANDOM'"#'  *.py
sed -i 's#os.remove(self.file.*#pass#'  *.py
\end{verbatim}

\subsection{Test tst\_atts.py}

\begin{verbatim}
E[ESDM NC] called ESDM_close:668 65536

======================================================================
ERROR: runTest (__main__.VariablesTestCase)
testing attributes
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_atts.py", line 53, in setUp
    f.stringseqatt = STRINGSEQATT
  File "netCDF4/_netCDF4.pyx", line 2918, in netCDF4._netCDF4.Dataset.__setattr__
  File "netCDF4/_netCDF4.pyx", line 2848, in netCDF4._netCDF4.Dataset.setncattr
  File "netCDF4/_netCDF4.pyx", line 1587, in netCDF4._netCDF4._set_att
OSError: array string attributes can only be written with NETCDF4

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_cdf5.py}

\begin{verbatim}
[ESDM NC] called ESDM_get_att:1356 65536
F
======================================================================
FAIL: runTest (__main__.test_cdf5)
testing NETCDF3_64BIT_DATA format (CDF-5)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_cdf5.py", line 34, in runTest
    assert (type(f.int64_attr) == np.int64)
AssertionError

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_compound\_alignment.py}

\begin{verbatim}
[ESDM NC] called ESDM__enddef:619 65536
E
======================================================================
ERROR: runTest (__main__.CompoundAlignTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_compound_alignment.py", line 90, in setUp
    v_cells = dataset.createVariable("cells",cell_cmp_dtype,"number_cells")
  File "netCDF4/_netCDF4.pyx", line 2772, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 3809, in netCDF4._netCDF4.Variable.__init__
  File "netCDF4/_netCDF4.pyx", line 1891, in netCDF4._netCDF4._ensure_nc_success
RuntimeError: NetCDF: Not a valid data type or _FillValue type mismatch

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_compoundatt.py}

\begin{verbatim}
[ESDM NC] called ESDM__enddef:619 65536
E
======================================================================
ERROR: runTest (__main__.VariablesTestCase)
testing compound attributes
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_compoundatt.py", line 36, in setUp
    v = f.createVariable(VAR_NAME,wind_vector_type, DIM_NAME)
  File "netCDF4/_netCDF4.pyx", line 2772, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 3809, in netCDF4._netCDF4.Variable.__init__
  File "netCDF4/_netCDF4.pyx", line 1891, in netCDF4._netCDF4._ensure_nc_success
RuntimeError: NetCDF: Not a valid data type or _FillValue type mismatch

----------------------------------------------------------------------
Ran 1 test in 0.002s
\end{verbatim}

\subsection{Test tst\_compoundvar.py}

\begin{verbatim}
[ESDM NC] called ESDM_inq:826 65536
E
======================================================================
ERROR: runTest (__main__.VariablesTestCase)
testing compound variables
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_compoundvar.py", line 60, in setUp
    g = f.groups[GROUP_NAME]
KeyError: 'phony_group'

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_compression.py}

\begin{verbatim}
[ESDM NC] called ESDM_close:668 65536
E
======================================================================
ERROR: runTest (__main__.CompressionTestCase)
testing zlib and shuffle compression filters
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_compression.py", line 70, in runTest
    uncompressed_size = os.stat(self.files[0]).st_size
FileNotFoundError: [Errno 2] No such file or directory: 'esdm://testfile12246'

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_create\_mem.py}

\begin{verbatim}
OK

[ESDM NC] called ESDM_open:467 test2.nc 65536 0 test2.nc
E
======================================================================
ERROR: test_mem_create (__main__.TestCreateMem)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_create_mem.py", line 22, in test_mem_create
    check_inmemory('NETCDF3_CLASSIC')
  File "tst_create_mem.py", line 19, in check_inmemory
    nc2 = netCDF4.Dataset('test2.nc','r',memory=b)
  File "netCDF4/_netCDF4.pyx", line 2325, in netCDF4._netCDF4.Dataset.__init__
  File "netCDF4/_netCDF4.pyx", line 1889, in netCDF4._netCDF4._ensure_nc_success
OSError: [Errno -77] NetCDF: Access failure: b'test2.nc'

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_dap.py}

\begin{verbatim}
[ESDM NC] called ESDM_open:467 http://remotetest.unidata.ucar.edu/thredds/dodsC/testdods/testData.nc 65536 0 http://remotetest.unidata.ucar.edu/thredds/dodsC/testdods/testData.nc
E
======================================================================
ERROR: runTest (__main__.DapTestCase)
testing access of data over http using opendap
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_dap.py", line 23, in runTest
    ncfile = netCDF4.Dataset(URL)
  File "netCDF4/_netCDF4.pyx", line 2325, in netCDF4._netCDF4.Dataset.__init__
  File "netCDF4/_netCDF4.pyx", line 1889, in netCDF4._netCDF4._ensure_nc_success
OSError: [Errno -77] NetCDF: Access failure: b'http://remotetest.unidata.ucar.edu/thredds/dodsC/testdods/testData.nc'

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_dims.py}

\begin{verbatim}
[ESDM NC] WARN ESDM_def_grp():2203. ESDM does not support groups from NetCDF!
E
======================================================================
ERROR: runTest (__main__.DimensionsTestCase)
testing dimensions
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_dims.py", line 38, in setUp
    g.createDimension(LAT_NAME,LAT_LENG)
  File "netCDF4/_netCDF4.pyx", line 2566, in netCDF4._netCDF4.Dataset.createDimension
  File "netCDF4/_netCDF4.pyx", line 3372, in netCDF4._netCDF4.Dimension.__init__
  File "netCDF4/_netCDF4.pyx", line 1891, in netCDF4._netCDF4._ensure_nc_success
RuntimeError: NetCDF: Not a valid ID

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_diskless.py}

\begin{verbatim}
[ESDM NC] called ESDM_create:404 tmp/tmpuk5aaae_.nc 65536 0 /tmp/tmpuk5aaae_.nc
E
======================================================================
ERROR: runTest (__main__.DisklessTestCase)
testing diskless file capability
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_diskless.py", line 24, in setUp
    f = netCDF4.Dataset(self.file,'w',diskless=True, persist=False)
  File "netCDF4/_netCDF4.pyx", line 2325, in netCDF4._netCDF4.Dataset.__init__
  File "netCDF4/_netCDF4.pyx", line 1889, in netCDF4._netCDF4._ensure_nc_success
OSError: [Errno -35] NetCDF: File exists && NC_NOCLOBBER: b'/tmp/tmpuk5aaae_.nc'

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_endian.py}

\begin{verbatim}
[ESDM NC] called ESDM_def_var:1494 65536 big-little
[ESDM NC] called ESDM_def_var:1503 65536: varid: 0
0 = 0
1 = 4
E
======================================================================
ERROR: runTest (__main__.EndianTestCase)
testing endian conversion capability
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_endian.py", line 162, in runTest
    check_byteswap(self.file3, data)
  File "tst_endian.py", line 41, in check_byteswap
    bl = dataset.createVariable('big-little', np.float32, dims, endian='big')
  File "netCDF4/_netCDF4.pyx", line 2772, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 3875, in netCDF4._netCDF4.Variable.__init__
RuntimeError: only endian='native' allowed for NETCDF3 files

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_enum.py}

\begin{verbatim}
[ESDM NC] called ESDM__enddef:619 65536
E
======================================================================
ERROR: runTest (__main__.EnumTestCase)
testing enum data type
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_enum.py", line 35, in setUp
    fill_value=ENUM_DICT['Missing'])
  File "netCDF4/_netCDF4.pyx", line 2772, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 3809, in netCDF4._netCDF4.Variable.__init__
  File "netCDF4/_netCDF4.pyx", line 1891, in netCDF4._netCDF4._ensure_nc_success
RuntimeError: NetCDF: Not a valid data type or _FillValue type mismatch

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_fancyslicing.py}

\begin{verbatim}
======================================================================
ERROR: test2unlim (__main__.VariablesTestCase)
Test with a variable that has two unlimited dimensions.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_fancyslicing.py", line 169, in test2unlim
    v[:] = data
  File "netCDF4/_netCDF4.pyx", line 4945, in netCDF4._netCDF4.Variable.__setitem__
  File "netCDF4/_netCDF4.pyx", line 5203, in netCDF4._netCDF4.Variable._put
IndexError: size of data array does not conform to slice

======================================================================
FAIL: test_get (__main__.VariablesTestCase)
testing 'fancy indexing'
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_fancyslicing.py", line 84, in test_get
    assert_array_equal(v[0:-1:2,i,:],self.data[0:-1:2,i,:])
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 854, in assert_array_equal
    verbose=verbose, header='Arrays are not equal')
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 778, in assert_array_compare
    raise AssertionError(msg)
AssertionError:
Arrays are not equal

(mismatch 75.0%)
 x: MaskedArray([[[-100, -100, -100, -100, -100, -100, -100, -100, -100, -100,
               -100],
              [-100, -100, -100, -100, -100, -100, -100, -100, -100, -100,...
 y: array([[[-300, -300, -300, -300, -300, -300, -300, -300, -300, -300, -300],
        [-300, -300, -300, -300, -300, -300, -300, -300, -300, -300, -300],
        [-300, -300, -300, -300, -300, -300, -300, -300, -300, -300, -300]],...

----------------------------------------------------------------------
Ran 3 tests in 0.039s

FAILED (failures=1, errors=1)
[ESDM NC] called ESDM_close:668 65536
[ESDM NC] called ESDM_close:668 131072
\end{verbatim}

\subsection{Test tst\_filepath.py}

\begin{verbatim}
[ESDM NC] called ESDM_open:467 home/lucy/esiwace/esdm-netcdf/dev/netcdf4-python/test/netcdf_dummy_file.nc 65536 0 /home/lucy/esiwace/esdm-netcdf/dev/netcdf4-python/test/netcdf_dummy_file.nc
E
======================================================================
ERROR: test_filepath (__main__.test_filepath)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_filepath.py", line 11, in setUp
    self.nc = netCDF4.Dataset(self.netcdf_file)
  File "netCDF4/_netCDF4.pyx", line 2325, in netCDF4._netCDF4.Dataset.__init__
  File "netCDF4/_netCDF4.pyx", line 1889, in netCDF4._netCDF4._ensure_nc_success
OSError: [Errno -77] NetCDF: Access failure: b'/home/lucy/esiwace/esdm-netcdf/dev/netcdf4-python/test/netcdf_dummy_file.nc'

======================================================================
ERROR: test_filepath_with_non_ascii_characters (__main__.test_filepath)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_filepath.py", line 11, in setUp
    self.nc = netCDF4.Dataset(self.netcdf_file)
  File "netCDF4/_netCDF4.pyx", line 2325, in netCDF4._netCDF4.Dataset.__init__
  File "netCDF4/_netCDF4.pyx", line 1889, in netCDF4._netCDF4._ensure_nc_success
OSError: [Errno -77] NetCDF: Access failure: b'/home/lucy/esiwace/esdm-netcdf/dev/netcdf4-python/test/netcdf_dummy_file.nc'

======================================================================
ERROR: test_no_such_file_raises (__main__.test_filepath)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_filepath.py", line 11, in setUp
    self.nc = netCDF4.Dataset(self.netcdf_file)
  File "netCDF4/_netCDF4.pyx", line 2325, in netCDF4._netCDF4.Dataset.__init__
  File "netCDF4/_netCDF4.pyx", line 1889, in netCDF4._netCDF4._ensure_nc_success
OSError: [Errno -77] NetCDF: Access failure: b'/home/lucy/esiwace/esdm-netcdf/dev/netcdf4-python/test/netcdf_dummy_file.nc'

----------------------------------------------------------------------
Ran 3 tests in 0.004s

FAILED (errors=3)
\end{verbatim}

\subsection{Test tst\_get\_variables\_by\_attributes.py}

\begin{verbatim}
OK

E
======================================================================
ERROR: test_find_variables_by_attribute_and_lambda (__main__.VariablesByAttributesTests)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_get_variables_by_attributes.py", line 10, in setUp
    self.nc = netCDF4.Dataset(netcdf_file)
  File "netCDF4/_netCDF4.pyx", line 2325, in netCDF4._netCDF4.Dataset.__init__
  File "netCDF4/_netCDF4.pyx", line 1889, in netCDF4._netCDF4._ensure_nc_success
OSError: [Errno -77] NetCDF: Access failure: b'netcdf_dummy_file.nc'

======================================================================
ERROR: test_find_variables_by_multiple_attribute (__main__.VariablesByAttributesTests)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_get_variables_by_attributes.py", line 10, in setUp
    self.nc = netCDF4.Dataset(netcdf_file)
  File "netCDF4/_netCDF4.pyx", line 2325, in netCDF4._netCDF4.Dataset.__init__
  File "netCDF4/_netCDF4.pyx", line 1889, in netCDF4._netCDF4._ensure_nc_success
OSError: [Errno -77] NetCDF: Access failure: b'netcdf_dummy_file.nc'

======================================================================
ERROR: test_find_variables_by_multiple_lambdas (__main__.VariablesByAttributesTests)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_get_variables_by_attributes.py", line 10, in setUp
    self.nc = netCDF4.Dataset(netcdf_file)
  File "netCDF4/_netCDF4.pyx", line 2325, in netCDF4._netCDF4.Dataset.__init__
  File "netCDF4/_netCDF4.pyx", line 1889, in netCDF4._netCDF4._ensure_nc_success
OSError: [Errno -77] NetCDF: Access failure: b'netcdf_dummy_file.nc'

======================================================================
ERROR: test_find_variables_by_single_attribute (__main__.VariablesByAttributesTests)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_get_variables_by_attributes.py", line 10, in setUp
    self.nc = netCDF4.Dataset(netcdf_file)
  File "netCDF4/_netCDF4.pyx", line 2325, in netCDF4._netCDF4.Dataset.__init__
  File "netCDF4/_netCDF4.pyx", line 1889, in netCDF4._netCDF4._ensure_nc_success
OSError: [Errno -77] NetCDF: Access failure: b'netcdf_dummy_file.nc'

======================================================================
ERROR: test_find_variables_by_single_lambda (__main__.VariablesByAttributesTests)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_get_variables_by_attributes.py", line 10, in setUp
    self.nc = netCDF4.Dataset(netcdf_file)
  File "netCDF4/_netCDF4.pyx", line 2325, in netCDF4._netCDF4.Dataset.__init__
  File "netCDF4/_netCDF4.pyx", line 1889, in netCDF4._netCDF4._ensure_nc_success
OSError: [Errno -77] NetCDF: Access failure: b'netcdf_dummy_file.nc'

----------------------------------------------------------------------
Ran 5 tests in 0.002s

FAILED (errors=5)
\end{verbatim}

\subsection{Test tst\_grps.py}

\begin{verbatim}
[ESDM NC] WARN ESDM_def_grp():2203. ESDM does not support groups from NetCDF!
E
======================================================================
ERROR: runTest (__main__.GroupsTestCase)
testing groups
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_grps.py", line 46, in setUp
    g2 = g1.createGroup(MARGARET)
  File "netCDF4/_netCDF4.pyx", line 2825, in netCDF4._netCDF4.Dataset.createGroup
  File "netCDF4/_netCDF4.pyx", line 3265, in netCDF4._netCDF4.Group.__init__
  File "netCDF4/_netCDF4.pyx", line 1891, in netCDF4._netCDF4._ensure_nc_success
RuntimeError: NetCDF: Not a valid ID

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_grps2.py}

\begin{verbatim}
[ESDM NC] WARN ESDM_def_grp():2203. ESDM does not support groups from NetCDF!
E
======================================================================
ERROR: runTest (__main__.Groups2TestCase)
testing implicit group and creation and Dataset.__getitem__
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_grps2.py", line 21, in setUp
    v = f.createVariable('/grouped/data/v',float,('x',))
  File "netCDF4/_netCDF4.pyx", line 2770, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 2825, in netCDF4._netCDF4.Dataset.createGroup
  File "netCDF4/_netCDF4.pyx", line 3265, in netCDF4._netCDF4.Group.__init__
  File "netCDF4/_netCDF4.pyx", line 1891, in netCDF4._netCDF4._ensure_nc_success
RuntimeError: NetCDF: Not a valid ID

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_issue908.py}

\begin{verbatim}
OK

[ESDM NC] called ESDM_open:467 CRM032_test1.nc 65536 0 CRM032_test1.nc
E
======================================================================
ERROR: runTest (__main__.Issue908TestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_issue908.py", line 7, in setUp
    nc = netCDF4.Dataset('CRM032_test1.nc')
  File "netCDF4/_netCDF4.pyx", line 2325, in netCDF4._netCDF4.Dataset.__init__
  File "netCDF4/_netCDF4.pyx", line 1889, in netCDF4._netCDF4._ensure_nc_success
OSError: [Errno -77] NetCDF: Access failure: b'CRM032_test1.nc'

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_masked.py}

\begin{verbatim}
OK
\end{verbatim}

\subsection{Test tst\_masked2.py}

\begin{verbatim}
[ESDM NC] called ESDM_inq_att:1120 65536 name:add_offset
/usr/lib/python3/dist-packages/numpy/core/arrayprint.py:686: UserWarning: Warning: converting a masked element to nan.
  s = self.format % x
F
======================================================================
FAIL: runTest (__main__.PrimitiveTypesTestCase)
testing auto-conversion of masked arrays and packed integers
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_masked2.py", line 82, in runTest
    assert_array_almost_equal(data,datacheck1)
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 962, in assert_array_almost_equal
    precision=decimal)
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 778, in assert_array_compare
    raise AssertionError(msg)
AssertionError:
Arrays are not almost equal to 6 decimals

(mismatch 100.0%)
 x: MaskedArray([  1.562500e+00,            nan,   3.750000e+00,   4.125000e+00], dtype=float32)
 y: MaskedArray([   nan,  5000.,  4000.,    nan])

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_masked3.py}

\begin{verbatim}
[ESDM NC] called ESDM_close:668 262144
.
======================================================================
ERROR: runTest (__main__.GlobalSetAutoMaskTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_masked3.py", line 149, in setUp
    grp1.createVariable('var1', 'f8', ())
  File "netCDF4/_netCDF4.pyx", line 2772, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 3809, in netCDF4._netCDF4.Variable.__init__
  File "netCDF4/_netCDF4.pyx", line 1891, in netCDF4._netCDF4._ensure_nc_success
RuntimeError: NetCDF: Not a valid ID

======================================================================
FAIL: test_scaled (__main__.SetAutoMaskFalse)
Testing auto-conversion of masked arrays for set_auto_mask(False) with scaling
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_masked3.py", line 86, in test_scaled
    self.assertEqual(v.dtype, "f8")
AssertionError: dtype('int16') != 'f8'

======================================================================
FAIL: test_scaled (__main__.SetAutoMaskTrue)
Testing auto-conversion of masked arrays for set_auto_mask(True)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_masked3.py", line 129, in test_scaled
    self.assertEqual(v_ma.dtype, "f8")
AssertionError: dtype('int16') != 'f8'

----------------------------------------------------------------------
Ran 5 tests in 0.021s
\end{verbatim}

\subsection{Test tst\_masked4.py}

\begin{verbatim}
[ESDM NC] called ESDM_inq_att:1120 65536 name:add_offset
F
======================================================================
FAIL: test_scaled (__main__.SetValidMinMax)
Testing auto-conversion of masked arrays
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_masked4.py", line 87, in test_scaled
    self.assertEqual(v.dtype, "f8")
AssertionError: dtype('int16') != 'f8'

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_masked5.py}

\begin{verbatim}
[ESDM NC] called ESDM_inq_var_all:1854 65536 0
E
======================================================================
ERROR: test_scaled (__main__.VectorMissingValues)
Testing auto-conversion of masked arrays
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_masked5.py", line 27, in setUp
    v2 = f.createVariable('v2',str,'x',fill_value=u'<missing>')
  File "netCDF4/_netCDF4.pyx", line 2772, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 3741, in netCDF4._netCDF4.Variable.__init__
ValueError: Variable length strings are only supported for the NETCDF4 format. For other formats, consider using netCDF4.stringtochar to convert string arrays into character arrays with an additional dimension.

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_masked6.py}

\begin{verbatim}
[ESDM NC] called ESDM_close:668 131072
.
======================================================================
ERROR: runTest (__main__.GlobalSetAlwaysMaskTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_masked6.py", line 96, in setUp
    grp1.createVariable('var1', 'f8', ())
  File "netCDF4/_netCDF4.pyx", line 2772, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 3809, in netCDF4._netCDF4.Variable.__init__
  File "netCDF4/_netCDF4.pyx", line 1891, in netCDF4._netCDF4._ensure_nc_success
RuntimeError: NetCDF: Not a valid ID

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_multifile.py}

\begin{verbatim}
[ESDM NC] called ESDM_inq_att:1120 131072 name:add_offset
F
======================================================================
FAIL: runTest (__main__.NonuniformTimeTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_multifile.py", line 146, in runTest
    assert_equal(date2index(datetime.datetime(1980, 1, 2), T), 366)
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 416, in assert_equal
    raise AssertionError(msg)
AssertionError:
Items are not equal:
 ACTUAL: 1
 DESIRED: 366

======================================================================
FAIL: runTest (__main__.VariablesTestCase)
testing multi-file dataset access
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_multifile.py", line 52, in runTest
    assert_array_equal(np.arange(0,nx),f.variables['x'][:])
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 854, in assert_array_equal
    verbose=verbose, header='Arrays are not equal')
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 778, in assert_array_compare
    raise AssertionError(msg)
AssertionError:
Arrays are not equal

(mismatch 90.0%)
 x: array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
       34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,...
 y: array([90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 90, 91, 92, 93, 94, 95, 96,
       97, 98, 99, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 90, 91, 92, 93,
       94, 95, 96, 97, 98, 99, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 90,...

----------------------------------------------------------------------
Ran 2 tests in 0.052s
\end{verbatim}

\subsection{Test tst\_multifile2.py}

\begin{verbatim}
[ESDM NC] called ESDM_inq_att:1120 131072 name:add_offset
F
======================================================================
FAIL: runTest (__main__.NonuniformTimeTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_multifile2.py", line 131, in runTest
    assert_equal(date2index(datetime.datetime(1980, 1, 2), T), 366)
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 416, in assert_equal
    raise AssertionError(msg)
AssertionError:
Items are not equal:
 ACTUAL: 1
 DESIRED: 366

======================================================================
FAIL: runTest (__main__.VariablesTestCase)
testing multi-file dataset access
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_multifile2.py", line 52, in runTest
    assert_array_equal(np.arange(0,nx),f.variables['x'][:])
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 854, in assert_array_equal
    verbose=verbose, header='Arrays are not equal')
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 778, in assert_array_compare
    raise AssertionError(msg)
AssertionError:
Arrays are not equal

(mismatch 90.0%)
 x: array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33,
       34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50,...
 y: array([90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 90, 91, 92, 93, 94, 95, 96,
       97, 98, 99, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 90, 91, 92, 93,
       94, 95, 96, 97, 98, 99, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 90,...

----------------------------------------------------------------------
Ran 2 tests in 0.070s
\end{verbatim}

\subsection{Test tst\_netcdftime.py}

\begin{verbatim}
OK
\end{verbatim}

\subsection{Test tst\_open\_mem.py}

\begin{verbatim}
[lucy-GS70-2PC-Stealth:01291] Signal: Segmentation fault (11)
\end{verbatim}

\subsection{Test tst\_refcount.py}

\begin{verbatim}
OK
\end{verbatim}

\subsection{Test tst\_rename.py}

\begin{verbatim}
[ESDM NC] WARN ESDM_def_grp():2203. ESDM does not support groups from NetCDF!
E
======================================================================
ERROR: runTest (__main__.VariablesTestCase)
testing renaming of dimensions, variables and attribute deletion
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_rename.py", line 36, in setUp
    g.createDimension(LAT_NAME,145)
  File "netCDF4/_netCDF4.pyx", line 2566, in netCDF4._netCDF4.Dataset.createDimension
  File "netCDF4/_netCDF4.pyx", line 3372, in netCDF4._netCDF4.Dimension.__init__
  File "netCDF4/_netCDF4.pyx", line 1891, in netCDF4._netCDF4._ensure_nc_success
RuntimeError: NetCDF: Not a valid ID

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_scalarvar.py}

\begin{verbatim}
[ESDM NC] WARN ESDM_def_grp():2203. ESDM does not support groups from NetCDF!
E
======================================================================
ERROR: runTest (__main__.ScalarVariableTestCase)
testing scalar variables
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_scalarvar.py", line 28, in setUp
    tempg = subgroup.createVariable(VAR_NAME,VAR_TYPE)
  File "netCDF4/_netCDF4.pyx", line 2772, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 3809, in netCDF4._netCDF4.Variable.__init__
  File "netCDF4/_netCDF4.pyx", line 1891, in netCDF4._netCDF4._ensure_nc_success
RuntimeError: NetCDF: Not a valid ID

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_scaled.py}

\begin{verbatim}
[ESDM NC] called ESDM_close:668 65536
.
======================================================================
ERROR: runTest (__main__.GlobalSetAutoScaleTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_scaled.py", line 207, in setUp
    grp1.createVariable('var1', 'f8', ())
  File "netCDF4/_netCDF4.pyx", line 2772, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 3809, in netCDF4._netCDF4.Variable.__init__
  File "netCDF4/_netCDF4.pyx", line 1891, in netCDF4._netCDF4._ensure_nc_success
RuntimeError: NetCDF: Not a valid ID

======================================================================
FAIL: test_masked (__main__.SetAutoScaleTrue)
Testing auto-scaling of variables for set_auto_scale(True) with masking
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_scaled.py", line 145, in test_masked
    assert_array_almost_equal(v_ma_scaled, self.v_ma_scaled)
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 962, in assert_array_almost_equal
    precision=decimal)
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 778, in assert_array_compare
    raise AssertionError(msg)
AssertionError:
Arrays are not almost equal to 6 decimals

(mismatch 100.0%)
 x: MaskedArray([  0.000000e+00,   5.000000e+01,   4.000000e+01,  -9.999000e+04])
 y: MaskedArray([   nan,    55.,    45.,    nan])

======================================================================
FAIL: test_unmasked (__main__.SetAutoScaleTrue)
Testing auto-scaling of variables for set_auto_scale(True)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_scaled.py", line 122, in test_unmasked
    assert_array_almost_equal(v_scaled, self.v_scaled)
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 962, in assert_array_almost_equal
    precision=decimal)
  File "/usr/lib/python3/dist-packages/numpy/testing/utils.py", line 778, in assert_array_compare
    raise AssertionError(msg)
AssertionError:
Arrays are not almost equal to 6 decimals

(mismatch 100.0%)
 x: MaskedArray([  0.000000e+00,   5.000000e+01,   4.000000e+01,  -9.999000e+04])
 y: array([  5.000000e+00,   5.500000e+01,   4.500000e+01,  -9.998500e+04])

----------------------------------------------------------------------
Ran 6 tests in 0.039s

FAILED (failures=2, errors=1)
\end{verbatim}

\subsection{Test tst\_shape.py}

\begin{verbatim}
OK
\end{verbatim}

\subsection{Test tst\_slicing.py}

\begin{verbatim}
[ESDM NC] called ESDM_inq_dim:980 zu
E
======================================================================
ERROR: test_0d (__main__.VariablesTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_slicing.py", line 33, in setUp
    vu[:,::-1,:] = data
  File "netCDF4/_netCDF4.pyx", line 4945, in netCDF4._netCDF4.Variable.__setitem__
  File "netCDF4/_netCDF4.pyx", line 5203, in netCDF4._netCDF4.Variable._put
IndexError: size of data array does not conform to slice

======================================================================
ERROR: test_1d (__main__.VariablesTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_slicing.py", line 33, in setUp
    vu[:,::-1,:] = data
  File "netCDF4/_netCDF4.pyx", line 4945, in netCDF4._netCDF4.Variable.__setitem__
  File "netCDF4/_netCDF4.pyx", line 5203, in netCDF4._netCDF4.Variable._put
IndexError: size of data array does not conform to slice

======================================================================
ERROR: test_3d (__main__.VariablesTestCase)
testing variable slicing
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_slicing.py", line 33, in setUp
    vu[:,::-1,:] = data
  File "netCDF4/_netCDF4.pyx", line 4945, in netCDF4._netCDF4.Variable.__setitem__
  File "netCDF4/_netCDF4.pyx", line 5203, in netCDF4._netCDF4.Variable._put
IndexError: size of data array does not conform to slice

======================================================================
ERROR: test_issue259 (__main__.VariablesTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_slicing.py", line 33, in setUp
    vu[:,::-1,:] = data
  File "netCDF4/_netCDF4.pyx", line 4945, in netCDF4._netCDF4.Variable.__setitem__
  File "netCDF4/_netCDF4.pyx", line 5203, in netCDF4._netCDF4.Variable._put
IndexError: size of data array does not conform to slice

======================================================================
ERROR: test_issue300 (__main__.VariablesTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_slicing.py", line 33, in setUp
    vu[:,::-1,:] = data
  File "netCDF4/_netCDF4.pyx", line 4945, in netCDF4._netCDF4.Variable.__setitem__
  File "netCDF4/_netCDF4.pyx", line 5203, in netCDF4._netCDF4.Variable._put
IndexError: size of data array does not conform to slice

======================================================================
ERROR: test_issue306 (__main__.VariablesTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_slicing.py", line 33, in setUp
    vu[:,::-1,:] = data
  File "netCDF4/_netCDF4.pyx", line 4945, in netCDF4._netCDF4.Variable.__setitem__
  File "netCDF4/_netCDF4.pyx", line 5203, in netCDF4._netCDF4.Variable._put
IndexError: size of data array does not conform to slice

======================================================================
ERROR: test_issue371 (__main__.VariablesTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_slicing.py", line 33, in setUp
    vu[:,::-1,:] = data
  File "netCDF4/_netCDF4.pyx", line 4945, in netCDF4._netCDF4.Variable.__setitem__
  File "netCDF4/_netCDF4.pyx", line 5203, in netCDF4._netCDF4.Variable._put
IndexError: size of data array does not conform to slice

======================================================================
ERROR: test_issue743 (__main__.VariablesTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_slicing.py", line 33, in setUp
    vu[:,::-1,:] = data
  File "netCDF4/_netCDF4.pyx", line 4945, in netCDF4._netCDF4.Variable.__setitem__
  File "netCDF4/_netCDF4.pyx", line 5203, in netCDF4._netCDF4.Variable._put
IndexError: size of data array does not conform to slice

======================================================================
ERROR: test_issue906 (__main__.VariablesTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_slicing.py", line 33, in setUp
    vu[:,::-1,:] = data
  File "netCDF4/_netCDF4.pyx", line 4945, in netCDF4._netCDF4.Variable.__setitem__
  File "netCDF4/_netCDF4.pyx", line 5203, in netCDF4._netCDF4.Variable._put
IndexError: size of data array does not conform to slice

======================================================================
ERROR: test_issue919 (__main__.VariablesTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_slicing.py", line 33, in setUp
    vu[:,::-1,:] = data
  File "netCDF4/_netCDF4.pyx", line 4945, in netCDF4._netCDF4.Variable.__setitem__
  File "netCDF4/_netCDF4.pyx", line 5203, in netCDF4._netCDF4.Variable._put
IndexError: size of data array does not conform to slice

======================================================================
ERROR: test_issue922 (__main__.VariablesTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_slicing.py", line 33, in setUp
    vu[:,::-1,:] = data
  File "netCDF4/_netCDF4.pyx", line 4945, in netCDF4._netCDF4.Variable.__setitem__
  File "netCDF4/_netCDF4.pyx", line 5203, in netCDF4._netCDF4.Variable._put
IndexError: size of data array does not conform to slice

======================================================================
ERROR: test_retain_single_dims (__main__.VariablesTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_slicing.py", line 33, in setUp
    vu[:,::-1,:] = data
  File "netCDF4/_netCDF4.pyx", line 4945, in netCDF4._netCDF4.Variable.__setitem__
  File "netCDF4/_netCDF4.pyx", line 5203, in netCDF4._netCDF4.Variable._put
IndexError: size of data array does not conform to slice

----------------------------------------------------------------------
Ran 12 tests in 0.027s
\end{verbatim}

\subsection{Test tst\_stringarr.py}

\begin{verbatim}
OK
\end{verbatim}

\subsection{Test tst\_types.py}

\begin{verbatim}
OK
\end{verbatim}

\subsection{Test tst\_unicode.py}

\begin{verbatim}
E[ESDM NC] called ESDM_close:668 65536

======================================================================
ERROR: runTest (__main__.UnicodeTestCase)
testing unicode
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_unicode.py", line 19, in setUp
    f.attribute3 = ATT3
  File "netCDF4/_netCDF4.pyx", line 2918, in netCDF4._netCDF4.Dataset.__setattr__
  File "netCDF4/_netCDF4.pyx", line 2848, in netCDF4._netCDF4.Dataset.setncattr
  File "netCDF4/_netCDF4.pyx", line 1587, in netCDF4._netCDF4._set_att
OSError: array string attributes can only be written with NETCDF4

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_unicode3.py}

\begin{verbatim}
E[ESDM NC] called ESDM_close:668 65536

======================================================================
ERROR: runTest (__main__.UnicodeTestCase)
testing unicode
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_unicode3.py", line 19, in setUp
    f.attribute3 = ATT3
  File "netCDF4/_netCDF4.pyx", line 2918, in netCDF4._netCDF4.Dataset.__setattr__
  File "netCDF4/_netCDF4.pyx", line 2848, in netCDF4._netCDF4.Dataset.setncattr
  File "netCDF4/_netCDF4.pyx", line 1587, in netCDF4._netCDF4._set_att
OSError: array string attributes can only be written with NETCDF4

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_unicodeatt.py}

\begin{verbatim}
E[ESDM NC] called ESDM_close:668 65536

======================================================================
ERROR: runTest (__main__.UnicodeAttTestCase)
testing unicode attributes
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_unicodeatt.py", line 16, in setUp
    nc.setncattr_string('stratt3',b'\xb2`\xa4J Python')
  File "netCDF4/_netCDF4.pyx", line 2862, in netCDF4._netCDF4.Dataset.setncattr_string
OSError: file format does not support NC_STRING attributes

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_unlimdim.py}

\begin{verbatim}
[ESDM NC] called ESDM_inq_dim:969 65536 5
F
======================================================================
FAIL: runTest (__main__.UnlimdimTestCase)
testing unlimited dimensions
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_unlimdim.py", line 59, in runTest
    self.assertTrue(bar.shape == (n1dim,n2dim,n3dim))
AssertionError: False is not true

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_Unsigned.py}

\begin{verbatim}
OK

[ESDM NC] called ESDM_open:467 ubyte.nc 65536 0 ubyte.nc
E
======================================================================
ERROR: test_unsigned (__main__.Test_Unsigned)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_Unsigned.py", line 16, in test_unsigned
    f = netCDF4.Dataset("ubyte.nc")
  File "netCDF4/_netCDF4.pyx", line 2325, in netCDF4._netCDF4.Dataset.__init__
  File "netCDF4/_netCDF4.pyx", line 1889, in netCDF4._netCDF4._ensure_nc_success
OSError: [Errno -77] NetCDF: Access failure: b'ubyte.nc'

----------------------------------------------------------------------
Ran 1 test in 0.002s
\end{verbatim}

\subsection{Test tst\_utils.py}

\begin{verbatim}
OK
\end{verbatim}

\subsection{Test tst\_vars.py}

\begin{verbatim}
[ESDM NC] WARN ESDM_def_grp():2203. ESDM does not support groups from NetCDF!
E
======================================================================
ERROR: runTest (__main__.VariablesTestCase)
testing primitive variables
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_vars.py", line 38, in setUp
    g.createDimension(DIM1_NAME, DIM1_LEN)
  File "netCDF4/_netCDF4.pyx", line 2566, in netCDF4._netCDF4.Dataset.createDimension
  File "netCDF4/_netCDF4.pyx", line 3372, in netCDF4._netCDF4.Dimension.__init__
  File "netCDF4/_netCDF4.pyx", line 1891, in netCDF4._netCDF4._ensure_nc_success
RuntimeError: NetCDF: Not a valid ID

----------------------------------------------------------------------
\end{verbatim}

\subsection{Test tst\_vlen.py}

\begin{verbatim}
[ESDM NC] called ESDM_close:668 262144
.
======================================================================
ERROR: runTest (__main__.TestIntegerIndex)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_vlen.py", line 113, in runTest
    strtest.createVariable('tenstrings', str, ['tenstrings'])
  File "netCDF4/_netCDF4.pyx", line 2772, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 3741, in netCDF4._netCDF4.Variable.__init__
ValueError: Variable length strings are only supported for the NETCDF4 format. For other formats, consider using netCDF4.stringtochar to convert string arrays into character arrays with an additional dimension.

======================================================================
ERROR: runTest (__main__.TestObjectArrayIndexing)
testing vlen variables
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_vlen.py", line 132, in setUp
    (DIM2_NAME, DIM1_NAME))
  File "netCDF4/_netCDF4.pyx", line 2772, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 3741, in netCDF4._netCDF4.Variable.__init__
ValueError: Variable length strings are only supported for the NETCDF4 format. For other formats, consider using netCDF4.stringtochar to convert string arrays into character arrays with an additional dimension.

======================================================================
ERROR: runTest (__main__.TestScalarVlenString)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_vlen.py", line 99, in runTest
    teststring = f.createVariable('teststring', str)
  File "netCDF4/_netCDF4.pyx", line 2772, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 3741, in netCDF4._netCDF4.Variable.__init__
ValueError: Variable length strings are only supported for the NETCDF4 format. For other formats, consider using netCDF4.stringtochar to convert string arrays into character arrays with an additional dimension.

======================================================================
ERROR: runTest (__main__.VariablesTestCase)
testing vlen variables
----------------------------------------------------------------------
Traceback (most recent call last):
  File "tst_vlen.py", line 42, in setUp
    (DIM2_NAME,DIM1_NAME))
  File "netCDF4/_netCDF4.pyx", line 2772, in netCDF4._netCDF4.Dataset.createVariable
  File "netCDF4/_netCDF4.pyx", line 3741, in netCDF4._netCDF4.Variable.__init__
ValueError: Variable length strings are only supported for the NETCDF4 format. For other formats, consider using netCDF4.stringtochar to convert string arrays into character arrays with an additional dimension.

----------------------------------------------------------------------
Ran 6 tests in 0.008s

FAILED (errors=4)
----------------------------------------------------------------------
\end{verbatim}
